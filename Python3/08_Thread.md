# 多线程

## 区分并行与并发

Erlang 之父 Joe Armstrong 用一张5岁小孩都能看懂的图解释了并发与并行的区别。

![](https://pic2.zhimg.com/80/v2-a825e6507f99e6240807e4b1bdc9a721_720w.webp)

并发是两个队列交替使用一台咖啡机，并行是两个队列同时使用两台咖啡机。
如果串行，一个队列使用一台咖啡机，那么哪怕前面那个人便秘了去厕所呆半天，后面的人也只能死等着他回来才能去接咖啡，这效率无疑是最低的。

具体的，给并发和并行来个定义

- **并发**（concurrency）：
指计算机似乎能在同一时刻做许多件不同的事情。在单核CPU的计算机上面，操作系统可以迅速切换这个处理器所运行的程序，因此尽管同一时刻最多只有一个程序在运行，但这些程序能够交替地使用这个核心，从而造成一个假象，让人觉得它们好像真的在同时运行。
- **并行**（paralleslism）：
计算机真的能够在同一时刻做很多件不同的事情。例如，若计算机配有多个CPU核心，那么它就真的可以同时执行多个程序。每个CPU核心执行的都是自己的那个程序之中的指令，这些程序能够同时向前推进。

Q：何时使用并发，何时使用并行？
并发通常应用于 I/O 操作频繁的场景，比如你要从网站上下载多个文件，I/O 操作的时间可能会比 CPU 运行处理的时间长得多。
而并行则更多应用于 CPU heavy 的场景，比如 `Hadoop`、`Spark` 等 MapReduce 中的并行计算，为了加快运行速度，一般会用多台机器、多个处理器来完成。

## 参考文献

- [Python并发、并行编程概念篇：并行VS并发、同步VS异步](https://zhuanlan.zhihu.com/p/537188524)
- [python并发编程之多线程：thread、ThreadPoolExecutor](https://zhuanlan.zhihu.com/p/537193760)
- [Python并行编程：subprocess、ProcessPoolExecutor](https://zhuanlan.zhihu.com/p/537200884)
