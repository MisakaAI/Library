# 语言基础

## 编码

C#支持 `Unicode`字符编码集

## 类型

C#是一种强类型语言，每条数据必须又一个类型。

C#类型|.NET类型|大小（字节）|值/区间
-|-|-|-
byte|Byte|1|0 到 255
short|Int16|2|-32,768 到 32,767
int|Int32|4|-2,147,483,648 ~ 2,147,483,647
long|Int64|4|-9,223,372,036,854,775,808 ~ 9,223,372,036,854,775,807
float|Single|4|-3.402823e38 ~ 3.402823e38
double|Double|8|-1.79769313486232e308 ~ 1.79769313486232e308
decimal|Decimal|16|±1.0 × 10e28 to 7.9 × 10e28
bool|Boolean|1|true 或 false
char|Char|2|任意 Unicode 字符
string|String||字符序列
object|Object||所有其他类型的基类型

在C#中，类型分为两大类：值类型和引用类型。
它们的主要区别在于内存分配和存储方式。

- **值类型**
变量直接包含其数据，每个变量都有自己独立的数据副本。
当你将一个值类型变量赋值给另一个变量时，实际上是创建了这个值的副本，它们相互独立。

- **引用类型**
存储的是对象的引用（或地址），而不是对象本身的值。
多个变量可以引用同一个对象，改变其中一个变量的内容会影响其他引用同一对象的变量。

引用类型可以为空（null），但是值类型不可以。

```cs
// 值类型
int a = 5;
int b = a; // 这里 b 是 a 的副本
b = 10;
Console.WriteLine(a); // 输出 5，a 和 b 是独立的

// 引用类型
class Person
{
    public string Name;
}

Person person1 = new Person();
person1.Name = "Alice";

Person person2 = person1; // person2 和 person1 引用同一个对象
person2.Name = "Bob";

Console.WriteLine(person1.Name); // 输出 Bob，因为 person1 和 person2 指向同一个对象
```

## 变量

变量是数据占位符。
C#是一种强类型语言，因此每个变量必须有一个生命的类型。
C#中有两种数据类型。

- 引用类型：引用类型的变量提供了对对象的引用。
- 基本类型：基本类型变量保存了一个基本的数据。

## 常量

C#中可以在一个变量的声明前加上关键字 `const`
使这个值变为不可修改的常量。

## 直接量

- 基本类型直接量：
  - 整形直接量：`0` `1`
  - 浮点型直接量：`1.0`
  - 字符型直接量：`'x'` `'阿'`
  使用单引号 `'`
  - 布尔型直接量：`true` `False`
- 字符串直接量：`"Hello World!"` `"你好 世界！"`
使用双引号 `"`
- null直接量：`null`

## 类型转换

### 宽化转换

从一种类型到另一种类型转换时，后者大小和前者一样，甚至更大。
通常隐式进行。

```cs
int a = 10;
long b = a;
Console.WriteLine(a); // 10
Console.WriteLine(b); // 10
```

### 窄化转换

从一种类型到另一种类型更小的类型的转换，必须显示进行。
窄化转换会引起信息丢失，会使程序产生缺陷。

```cs
long a = 9876543210L;
int b = (int)a;
Console.WriteLine(a); // 9876543210
Console.WriteLine(b); // 1286608618
```

## 运算符

### 一元运算符

- 对操作数取反 `-`
- 返回操作数的值 `+` // 完全没用的操作
- 递增 `++`
- 递减 `--`
- 逻辑取反 `!`
- 按位求补 `~`
这个运算符的操作数必须是整数类型或者整形变量。
结果式对操作数的每位取反。

```cs
int j = 2;
int k = ~j;
// j = 2
// k = -3

// 二进制
// J: 0000 0000 0000 0000 0000 0000 0000 0010
// K: 1111 1111 1111 1111 1111 1111 1111 1101
```

- `Sizeof`
获取一个数据类型的字节长度：`sizeof(int)`

### 算数运算符

- 加 `+`
- 减 `-`
- 乘 `*`
- 除 `/`
- 模（余数）`%`
- 相等
  - 等于 `==`
  - 不等于 `!=`

## 关系运算符

- 小于 `<`
- 大于 `>`
- 小于等于 `<=`
- 大于等于 `>=`

## 条件运算符

- 与 `&&`
- 或 `||`
- 三元表达式 `?:`
`a ? b : c`
`a` 为 `true` 则返回 `b`，否则返回 `c`

## 位移运算符

- 左位移 `<<` 向左位移一个数字，空位补0
- 右位移 `>>` 向右位移一个数字，空位补0
- 无符号右位移 `>>>`
`n >>> s`：`n`的值向右位移`s`位。
若`n`为正值，和右位移`n >> s`结果一样。
若`n`为负值，且为`int`类型，则值为`(n>>s)+(2<<~s)`
若`n`为负值，且为`long`类型，则值为`(n>>s)+(2L<<~s)`

```cs
int a = 100;
int b = a << 3;
int c = a >> 3;
int d = (-a) >> 3;

/* 输出二进制表示 */

Console.WriteLine(Convert.ToString(a, 2).PadLeft(16, '0'));
// 0000000001100100

Console.WriteLine(Convert.ToString(b, 2).PadLeft(16, '0'));
// 0000001100100000

Console.WriteLine(Convert.ToString(c, 2).PadLeft(16, '0'));
// 0000000000001100

Console.WriteLine(Convert.ToString(d, 2).PadLeft(16, '0'));
Console.WriteLine(Convert.ToString(((-100)>>3)+(2<<~3), 2).PadLeft(32, '0'));
// 11111111111111111111111111110011
```

## 赋值运算符

`=` `+=` `-=` `*=` `/=` `%=` `<<=` `>>=` `>>>=` `&=` `^=` `|=`

```cs
int x = 3;

x += 1;
x = x + 1;
```

## 整形位运算符

`&` 与
`|` 或
`^` 异或

```cs
// & 与
true & true = true
true & false = false
false & false = false

// | 或
true | true = true
true | false = true
false | false = false

// ^ 异或
true ^ true = false
true ^ false = true
false ^ false = false
```

## 运算符优先级

计算顺序：

- 圆括号 `()`
- 后缀运算符 `[].(params)` `expr++` `expr--`
- 一元运算符 `++expr` `--expr` `+expr` `-expr` `~` `!`
- 创建或类型转换 `new (type)expr`
- 乘法 `*` `/` `%`
- 加法 `+` `-`
- 位移 `<<` `>>` `>>>`
- 关系 `<` `>` `<=` `>=`
- 相等 `==` `!=`
- 与 `&`
- 异或 `^`
- 或 `|`
- 逻辑与 `&&`
- 逻辑或 `||`
- 条件 `?:`
- 赋值 `==` `+=` `-=`

## 提升

有些一元运算符和二元运算符，会导致自动提升。
也就是提升到有更大存储空间的类型。

## 注释

- 传统注释：`/* */`
- 行末注释：`//`

## 一些来自 ChatGPT 的解释

### 位移运算符的常见作用

1. 快速乘除法运算
左移：将数值的二进制位向左移动 `n` 位，相当于将该数乘以 `2^n`
右移：将数值的二进制位向右移动 `n` 位，相当于将该数除以 `2^n`

2. 数据压缩和存储优化
在某些情况下，可以通过位移操作将多个小范围的整数值打包到一个较大的整数中，从而节省存储空间。
这种技术通常用于嵌入式系统、图像处理等领域。

3. 位标志处理
位移运算符在设置、清除或检查位标志时非常有用。
通常通过位与、位或操作结合位移运算符来操作特定位。

4. 循环移位（旋转位）
在某些算法（如加密算法）中，需要将数值的位进行循环移位操作，位移运算符结合与操作可以用来实现这一点。

5. 数据编码和解码
位移运算符可以用来实现一些简单的编码和解码操作。
例如，某些数据压缩算法或加密算法会使用位移来对数据进行混淆。

6. 位掩码的创建和解析
位移操作通常用于创建或解析位掩码，用于控制对某些位的访问或操作。
这在网络协议、硬件接口等领域非常常见。

7. 调整字节顺序
在处理字节序（大端/小端）问题时，位移运算符可以用于调整数据的字节顺序。
这在网络编程和跨平台开发中非常重要。

### 无符号右位移运算符的常见作用

1. 处理无符号数据
无符号右移操作对无符号整数进行右移时，可以确保结果不受到符号位的影响。
这在处理来自外部设备、文件格式或网络协议的数据时非常有用，因为这些数据通常以无符号形式存储。

2. 位级别的数据解析
当需要从二进制数据中提取特定的位段时，无符号右移非常有用。
例如，解析协议报文、文件头、或某些嵌入式系统中需要将位段从字节序列中分离出来时，可以使用无符号右移操作。

3. 快速除以2的幂
无符号右移操作相当于对数值进行快速除法操作，除数是2的幂。
这种方法在性能敏感的场景中比使用标准除法更高效。

4. 循环移位操作
在某些算法中，尤其是加密算法和哈希函数中，循环移位操作是常见的操作。
无符号右移可以确保在执行右移时不会引入额外的符号位。
